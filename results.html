<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>merMER Results</title>

    <!-- Bootstrap CSS DONT TOUCH -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">

    <!-- For sidebar + icons-->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
    <style>
        /*TODO: Move to external CSS file, off of html*/
        .wrapper {
            display: flex;
            width:100%;
            align-items: stretch;
            background-color:aliceblue;
        }
        #content {
            width: calc(100% - 250px);
            padding: 40px;
            height: 100vh;
            transition: all 0.3s;
            position: relatve;
            top: 0;
            right: 0;
            
            
        }
#content.active {
    width: 100%;
    
}  

        #sidebar {
            background:rgb(229,66,67);
            color: #fff;
            transition: all 0.3s;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 999;
            max-width: 250px;
        }
        #sidebar.active {
            margin-left: -250px;
        }
        table{
            border:5px solid rgb(229,66,67);
            letter-spacing:1px;
            font-size:20px;
            text-align:center;

        }
        .td,th,tr{
            border:3px solid rgb(229,66,67);
            width:200px;
        }

#sidebar .sidebar-header {
    padding: 20px;
    background: rgb(229,66,67);
    text-align: center;
}

#sidebar ul.components {
    padding: 20px 0;
    border-bottom: 1px solid rgb(229,66,67);
}

#sidebar ul p {
    color: #fff;
    padding: 20px;
}

#sidebar ul li a {
    padding: 20px;
    font-size: 1.1em;
    display: block;
}
#sidebar ul li a:hover {
    color: #fff;
    background:rgb(229,66,67);
}

#sidebar ul li.active > a, a[aria-expanded="true"] {
    color: #fff;
    background: rgb(229,66,67);
}
ul ul a {
    font-size: 0.9em !important;
    padding-left: 30px !important;
    background:rgb(229,66,67);
}
a[data-toggle="collapse"] {
    position: relative;
}

.dropdown-toggle::after {
    display: block;
    position: absolute;
    top: 50%;
    right: 20px;
    transform: translateY(-50%);
}
a[aria-expanded="false"]::before, a[aria-expanded="true"]::before {
    content: '\e259';
    display: block;
    position: absolute;
    right: 20px;
    font-family: 'Glyphicons Halflings';
    font-size: 0.6em;
}
.pagination {
  position: fixed;
  bottom: 0;
  right:0;
}
    </style>
    <script src="https://d3js.org/d3.v5.min.js"></script> 
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
</head>

<body>
   
    <div class="wrapper">
        <!-- Sidebar -->
        <nav id="sidebar">
            <div class="sidebar-header">
                
                <div class="logo">
                    <a href="#"><img src="http://marksteinlab.org/wp-content/uploads/2015/06/Open-Fly-Community-Resource_Placeholder.jpg" class="img-fluid flex-center"></a> 
                  </div>
                  <h1>merMER</h1>
            </div>
    
            <ul class="list-unstyled components"> 
                <li class="active">
                    <p>Home</p>
                </li>
                <li class="active">
                    <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">IUPAC Codes</a>
                    <ul class="collapse list-unstyled" id="homeSubmenu">
                        <li>A   Adenine</li>
                        <li>C   Cytosine</li>
                        <li>G   Guanine</li>
                        <li>T   Thymine</li>
                        <li>U   Uracil</li>
                        <li>B = C|T|U|G = ~A</li>
                        <li>D = A|T|U|G = ~C</li>
                        <li>H = A|T|U|C = ~G</li>
                        <li>K = T|U|G</li>
                        <li>M = C|A</li>
                        <li>N = A|C|G|T|U</li>
                        <li>R = A|G</li>
                        <li>S = C|G</li>
                        <li>V = A|C|G = ~(T|U)</li>
                        <li>W = T|U|A</li>
                        <li>Y = C|T|U</li>
                    </ul>
                </li>

                <li class="active">
                    <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Restrictions</a>
                    <ul class="collapse list-unstyled" id="pageSubmenu">
                        <ul>
                            <input type="checkbox" name="UTR1" checked>
                                                    <label for="UTR1">5' UTR</label>
                                                    <br>
                                                    <input type="checkbox" name="UTR2" checked>
                                                    <label for="UTR2">3' UTR</label>
                                                    <br>
                                                    <input type="checkbox" name="CDS" checked>
                                                    <label for="CDS"> CDS</label>
                                                    <br>
                                                    <input type="checkbox" name="Exon" checked>
                                                    <label for="Exon"> Exon </label>
                                                    <br>
                                                    <input type="checkbox" name="Intron" checked>
                                                    <label for="Intron"> Intron</label>
                                                    <br>
                                                    <input type="checkbox" name="intergenic" checked>
                                                    <label for="intergenic">Intergenic</label>
                                                    <br><br>
                                          </ul>
                                          </ul>
                                          </li>
                                          </ul>
                                          </nav>
                    <!-- All result content -->
                    <div id="content">
                                <!-- Toggle -->
                                            <nav class="navbar navbar-expand-lg  ">
                                                <div class="container-fluid">
                                        
                                                    <button type="button" id="sidebarCollapse" class="btn ">
                                                        <i class="fas fa-align-left"></i>

                                                    </button>
                                                    <ul class="nav navbar-nav ml-auto">
                                                    <a href="2-8-19-58561.gff" download="logo">
                                                    <button type="button" class="btn btn-danger">Save Search</button>
                                                </a>
                                                    <a href="fake.json" download="logo">
                                                     <button type="button" class="btn btn-danger">Download Hits</button>
                                                    </a> 
                                                </ul>
                                                </div>
                                    
                                            </nav>
                                            

                                            
                                            <br>
                                           <div id="myData">
                                               <h5> Summary Table</h5>
                                                <table>
                                                    <tr>
                                                        <th>Query</th>
                                                        <th>Chromosome Number</th>
                                                        <th>Cluster</th>
                                                    </tr>
                                                </table>
                                            </div> 
                                            <br><br>
                                            <div id="results">
                                            <h5>Results</h5>
                                                <label for="gene1">Cluster 1:ABCB7</label>
                                                <script src="visualization.js"></script>
                                                <br><br>
                                                    <label for="gene2">Cluster 2: BRCA1</label>
                                                    <script src="visualization2.js"></script>
                                        
                                            </div>
                                    </div>
                                    <div class="pagination">
                                    <nav aria-label="Page navigation example">
                                        <ul class="pagination justify-content-end">
                                          <li class="page-item disabled">
                                            <a class="page-link" href="#" tabindex="-1">Previous</a>
                                          </li>
                                          <li class="page-item"><a class="page-link" href="#">1</a></li>
                                          <li class="page-item"><a class="page-link" href="#">2</a></li>
                                          <li class="page-item"><a class="page-link" href="#">3</a></li>
                                          <li class="page-item">
                                            <a class="page-link" href="#">Next</a>
                                          </li>
                                        </ul>
                                      </nav>
                                    </div>
                                    </div>

    <!-- jQuery CDN - Slim version (=without AJAX) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

</body>
<script>
    $(document).ready(function () {

        $('#sidebarCollapse').on('click', function () {
            $('#sidebar').toggleClass('active');
        });
    });
    fetch('fake.json')
            .then(function (response) {
                return response.json();
            })
            .then(function (data) {
                appendTable(data);
                appendStats(data);

            })
            .catch(function (err) {
                console.log('error: ' + err);
            });
        function appendTable(data) {
            var mainContainer = document.getElementById("myData");
            

            var hit = data.hits;
            var sequence = hit[0].sequence;
            var Query = data.query;
            var div = document.createElement("div");
            mainContainer.appendChild(div);           
            var tr;
        for(var j=0; j<hit.length;j++){
            var sequence = hit[j].sequence;
        for (var i = 0; i <2; i++) {
            tr = $('<tr/>');
            tr.append("<td>" + Query + "</td>");
            tr.append("<td>" + hit[j].chromosome + "</td>");
            tr.append("<td>"+ clusterSum(Query,sequence) + "</td>")
            i++;
            $('table').append(tr);
            };
        }
        }
        // Returns sum of queries
        function clusterSum(Query, sequence) {
            var Query = "GAG";
            var final = 0;
            var itr = 0;
            while ((itr = sequence.indexOf(Query,itr)) !=-1) {
                final++;
                itr++;
            }
            return final;
        }
        // Returns index of each query within the sequence
        function clusterNum(Query,sequence) {
            var clusters=[];
            var itr = 0;
            while ((itr = sequence.indexOf(Query,itr)) !=-1) {
                clusters.push(itr);
                final++;
                itr++;
            }
            return clusters;
        }
 
        
</script>

</html>
