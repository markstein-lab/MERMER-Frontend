// DONT TOUCH: Duplicate of visualization.js for BRCA1 to demonstrate this could work for multiple genes. Duplication made for planning/demonstration purposes
var temp ={
    "gene": [
      {
        "end": 1623413,
        "geneId": "FBgn0035244",
        "geneName": "ABCB7",
        "start": 1618414,
        "transcripts": [
          {
            "end": 1623413,
            "exons": [
              {
                "end": 1618617,
                "exonId": "FBgn0035244:1",
                "exonNumber": "1",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1618617,
                    "start": 1618501,
                    "type": "CDS"
                  },
                  {
                    "end": 1618503,
                    "start": 1618501,
                    "type": "start_codon"
                  }
                ],
                "start": 1618414
              },
              {
                "end": 1620554,
                "exonId": "FBgn0035244:2",
                "exonNumber": "2",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1620554,
                    "start": 1620428,
                    "type": "CDS"
                  }
                ],
                "start": 1620428
              },
              {
                "end": 1621042,
                "exonId": "FBgn0035244:3",
                "exonNumber": "3",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1621042,
                    "start": 1620817,
                    "type": "CDS"
                  }
                ],
                "start": 1620817
              },
              {
                "end": 1621257,
                "exonId": "FBgn0035244:5",
                "exonNumber": "4",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1621257,
                    "start": 1621103,
                    "type": "CDS"
                  }
                ],
                "start": 1621103
              },
              {
                "end": 1622665,
                "exonId": "FBgn0035244:6",
                "exonNumber": "5",
                "exonVersion": "1",
                "ranges": [
                   {
                    "end": 1622665,
                    "start": 1621317,
                    "type": "CDS"
                  }
                ],
                "start": 1621317
              },
              {
                "end": 1623413,
                "exonId": "FBgn0035244:8",
                "exonNumber": "6",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1622986,
                    "start": 1622732,
                    "type": "CDS"
                  },
                  {
                    "end": 1622989,
                    "start": 1622987,
                    "type": "stop_codon"
                  }
                ],
                "start": 1622732
              }
            ],
            "ranges": [
              {
                "end": 1618500,
                "start": 1618414,
                "type": "UTR"
              },
              {
                "end": 1623413,
                "start": 1622990,
                "type": "UTR"
              }
            ],
            "start": 1618414,
            "transcriptId": "FBtr0072754",
            "transcriptName": "BRCA-1"
          },
          {
            "end": 1623159,
            "exons": [
              {
                "end": 1618617,
                "exonId": "FBgn0035244:1",
                "exonNumber": "1",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1618617,
                    "start": 1618501,
                    "type": "CDS"
                  },
                  {
                    "end": 1618503,
                    "start": 1618501,
                    "type": "start_codon"
                  }
                ],
                "start": 1618414
              },
              {
                "end": 1620554,
                "exonId": "FBgn0035244:2",
                "exonNumber": "2",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1620554,
                    "start": 1620428,
                    "type": "CDS"
                  }
                ],
                "start": 1620428
              },
              {
                "end": 1621042,
                "exonId": "FBgn0035244:4",
                "exonNumber": "3",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1621042,
                    "start": 1620919,
                    "type": "CDS"
                  }
                ],
                "start": 1620919
              },
              {
                "end": 1621257,
                "exonId": "FBgn0035244:5",
                "exonNumber": "4",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1621257,
                    "start": 1621103,
                    "type": "CDS"
                  }
                ],
                "start": 1621103
              },
              {
                "end": 1622665,
                "exonId": "FBgn0035244:6",
                "exonNumber": "5",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1622665,
                    "start": 1621317,
                    "type": "CDS"
                  }
                ],
                "start": 1621317
              },
              {
                "end": 1623159,
                "exonId": "FBgn0035244:7",
                "exonNumber": "6",
                "exonVersion": "1",
                "ranges": [
                  {
                    "end": 1622986,
                    "start": 1622732,
                    "type": "CDS"
                  },
                  {
                    "end": 1622989,
                    "start": 1622987,
                    "type": "stop_codon"
                  }
                ],
                "start": 1622732
              }
            ],
            "ranges": [
              {
                "end": 1618500,
                "start": 1618414,
                "type": "UTR"
              },
              {
                "end": 1623159,
                "start": 1622990,
                "type": "UTR"
              }
            ],
            "start": 1618414,
            "transcriptId": "FBtr0072755",
            "transcriptName": "BRCA2"
          }
        ]
      }
    ],
    "hits": [
      {
        "chromosome": "chr3R",
        "gene": [],
        "position": "1618414",
        "sequence": "CCATGCGAATGCTGATATCGTAGCAAAAACACAGGGACGGTGCGAAAGAAGAGGGATTTTATTTTGTTTTCGCCTGGCAATTGAGTAATGGCCGGACTCCTTCACCTGACCAAGCAGTGCAGCATCCACCTACCCGCCCACTTGGGACGCGCGAAATGCTACACACTCGCTAAGGGACCGGGAACACACGTGCAGGCAAGAGTG"
      }
    ],
    "query": "GAG"
  }
  
    // TODO: Start and stop codons
    var ABCB7 = temp.gene[0];
    var query = temp.query;
    var sequence = temp.hits[0].sequence;
  
    var canva= d3.select('#results').append('svg')
        .attr('width',1000)
        .attr('height', 75)
        .style('border', '3px solid');
  
    var transcriptline = canva.selectAll('g')
      .data(ABCB7.transcripts)
      .enter()
      .append('g');
    var transcripts = transcriptline.attr('transform', (d,i) => 'translate(0, '+40*i+')')
      .append('rect')
      .attr("x", 10)
      .attr("y", 15)
      .attr("width",function(d) { return d.end-d.start + 10})
      .attr("height", 5)
      .attr("fill","black");
  
    var transcriptName = transcriptline.append('text')
      .attr("x",10)
      .attr("y", 15)
      .text(function(d) {return d.transcriptName})
      .attr("font-size", "15px")
      .attr("fill", "black");
    var transcriptText = transcriptline.selectAll('g')
      .data(ABCB7.transcripts)
      .enter()
      .append('g');  
     var exons =  transcriptline.selectAll('g')
      .data(function(d,i) { return ABCB7.transcripts[i].exons})
      .enter()
      .append('g');
  
    var exons2 = exons.append('rect')
      .attr("x", function(d,i) { return 10 + d.end - d.start})
      .attr("y",0)
      .attr("width", function(d,i) {return 10 + d.end-d.start})
      .attr("height", 30)
      .attr("fill", "black");
      var exons4 =  canva.selectAll('g')
      .data(function(d,i) { return [55,200,250]})
      .enter()
      .append('g');
    var exons3 = exons.append('rect')
      .attr("x", function(d,i) {
        return 110 + i*5;
      })
      .attr("y",0)
      .attr("width", function(d,i) {return 3 })
      .attr("height", 30)
      .attr("fill", "blue");
    var start = transcriptline.selectAll('g')
      .data(function(d,i) {return ABCB7.transcripts})
      .enter()
      .append('g');
  
    var startexon = exons.append('rect')
      .attr("x",function(d,i){return 10+d.end - d.start})
      .attr("y",0)
      .attr("width",function(d,i){
        if(d.exonNumber > 5){
          return 3;
        }
        else {
          return 0;
        }
      })
      .attr("height",30)
      .attr("fill", "blue");  
      var text2 = d3.select('#results').append('text')
        .attr("x",1000)
        .attr("y", 1500)
        .text(function(d) {return appendStats(ABCB7) })
        .attr("font-size", "15px")
        .attr("fill", "black");
    var start = transcriptline.selectAll('g')
      .data(function(d,i) {return ABCB7.transcripts})
      .enter()
      .append('g');
  
      var startexon = exons.append('rect')
      .attr("x",function(d,i){return 10+d.end - d.start})
      .attr("y",0)
      .attr("width",function(d,i){
        if(d.exonNumber == 4){
          return 3;
        }
        else {
          return 0;
        }
      })
      .attr("height",30)
      .attr("fill", "blue");
  /*   var lines = canva.append("line")
      .attr("x1",10)
      .attr("y1",)
      .attr("x2", function)
      .attr("y2",)
  
      
    group.selectAll(".line")
      .data(ABCB7.transcripts)
      .enter().append("path")
      .attr("class", "line")
      .attr("d", line); */
  /*   for (var transcripts in ABCB7) {
      if(!ABCB7.hasOwnProperty(trancripts)) {
        continue;
      }
      canva.append.line()
        .x(function(d,i){transcripts.end-transcripts.start;})
        .y(function(d,i){
          return (50*i+100);
      });
    }
    */
   var clusterNumbers = [100,220,230];
   function appendStats(data) {
    var mainContain3 = document.getElementById('results');
    
    var transcripts = data.gene[0].transcripts;
    for (var k=0; k<clusterNumbers.length;k++){
        console.log("K" + k);
    for(var j=0; j<transcripts.length+1; j++) {
        console.log("j" + j);
        var exons2 = transcripts[j].exons;
        for(var i=0; i<exons2.length;i++) {
            var div = document.createElement("div");
            if(clusterNumbers[k] + 1618414 > exons2[i].start && k<clusterNumbers.length);
                if (clusterNumbers[k] +1618414 <= exons2[i].end) {
                    var exons3 = exons2[i];
                    var exons4 = exons3.ranges;
                    console.log(exons4[0]);
                div.innerHTML = 'Cluster' + (k+1) + 'is in exon' + (i+1) + 'and ' + ((clusterNumbers[k] +1618414)-1618501) +'bp from the start codon' ;
                mainContain3.appendChild(div);
                
                


                k++;
                }
            }
        }
    }
}
   var datapath = "https://github.com/k8newcomer/test/blob/master/fly/fake.json"
   d3.json(datapath,function(data) {
    console.log(data.hits[0].chromosome);
   })
  